README by: Ethan F. Gyllenhaal
Last updated: 17 February 2026

# Yellow Whiskered Greenbul Phylogeography
Repository containing code from multiple contributors to collaborative manuscript on phylogeography of a forest generalist. It is sectioned to multiple sub-directories corresponding to general analysis types, roughly in the order of the first draft methods section. Contributors have uploaded scripts they wrote to the GitHub. Contributors other than EFG are noted in this README as well. Note that many scripts are built on backbones made by Joe Manthey.

A description of the directories and their contents are below.

## Useage

*** Denotes scripts not on github.


## Directories

### 01_read_processing_allignment

ragtag_correct.slurm - Slurm script for building RagTag scaffolded reference. First uses the Sylvia atricapilla genome to correct and then to scaffold the fragmented Eurillas latirostris reference.

01_index_reference.slurm - Slurm script for building BWA, samtools, and picard indices for the ragtag reference.

02_clean_align.slurm - Slurm array script (per individual) for cleaning reads (with bbduk), aligning them to the reference (with bwa), and cleaning and marking duplicates in that alignment (with Picard).

### 02_genotype

03_genotype.slurm - Slurm array script run per individual for genotyping SNPs. Simple bcftools mpileup pipeline. This is where the depth filter (>5) is applied.

03_stats.slurm - Script for outputting a series of stats for alignments and genotypes from past couple steps.

combine_stats.sh - Shell script for combining stats output by 03_stats.slurm into a table.

seq_stats.tsv - Sequencing stats generated by combine_stats.sh. Columns are:
* Name = sample name
* Mean depth = mean sequencing depth of coverage at sites with data
* Sites genotyped (Millions) = number of sites genotyped in VCF
* Cleaned reads (Millions) = number of paired-end reads (i.e., only read 1 total considered)

### 03_filtering

04_merge_filter.slurm - Slurm array script that runs across chromosomes, merging individuals into a single chromosome-specific VCF then performing basic filtering for either summary stats (at least 70% complete) or general use (at least 90% complete, MAC of 2, biallelic, max mean depth of 20, and thinned 10kb).

### 04_pca_admix

This section by Joe Manthey.

### 05_phylogenetics

This section by Swapnil Boyane and María Tocora.

### 06_mtDNA

This section by María Tocora.

### 07_summary_stats

\*\_popmap\*.txt - A set of population maps used for these scripts. Ones starting with "male" include only males, while those starting with "greenbul" include all samples. Ones with the baseline population split scheme only include the three major clsuters (East, Central, and West). The "fine" scheme splits out key divergent populations (e.g., Northeast, Rwenzori) and one with mitochondrial introgression. The "veryfine" scheme further breaks up the eastern populations.

calculate_windows\*.R - A series of R scripts based on ones JDM made for calculating windowed summary stats. The "fine" and "veryfine" refer to different population splitting decisions (see popmaps).

window_stat_calculations.R - R script by JDM for outputting windowed statistics.

sumstats100kbp\*\_array.slurm - Array job for running the calculate_windows R scripts, split into only male or all individuals.

cat_stats\*.slurm - A series of scripts for outputting individual windows into a genome-wide output file for plotting (windows\*.txt).

***window\*.txt - Series of text files containing windowed summary statistics. The second part of the name denotes the samples and chromosomes included, either all chromosomes and males only ("male100k") or autosomes only with all individuals ("noZ100k"). The "100k" refers to window size. The final part denotes the statistic in that script, either between-population diversity ("Dxy"), within population diversity ("pi" and "theta"), Tajima's D ("Tajima"), individual heterozygosity ("heterozygosity"), or population differentiation ("fst", Reich's estimator). A subset with "fine" in their names include finer scale population divisions, and "veryfine" even further divisions.

Greenbul_sumstats_plotting\*.R - A series of R scripts based on ones JDM made for plotting windowed summary stats. The "fine" and "veryfine" refer to different population splitting decisions (see popmaps), and "male" and "noZ" refer to sets of chromosomes and individuals includes. "male" includes only males and all chromosomes, "noZ" includes all individuals and only autosomes.

het_plot.R - A script for calculating bootstrapped estimates of genome-wide Tajima's D, plotting windowed Tajima's D, and plotting indivudal heterozygosity.

### 08_demography

make_gadma_thin.slurm - SLURM script for making GADMA input. First makes a full VCF, then thins it, then selects biallelic sites (after counting the number of total sites after thinning), and finally makes the SFS.

***greenbul47_biallelic1k_noZ_90.recode.vcf - VCF file generated first by thinning to 1000 SNPs including invariants, then subset to only biallelic sites.

***East-Central-West.sfs - 3D site-frequency spectrum produced by easySFS for use in GADMA.

run_gadma_1k.slurm - Slurm script for running GADMA.

params_file_1k - Parameter file for GADMA.

extra_params_file - Extra parameters file for GADMA.

edit_moments_fig.py - Python script of moments model generated by GADMA (hence few comments), but outputs as a PDF rather than PNG.

model_from_GADMA.pdf - Full uneditted GADMA output.

### 09_eems

***greenbul49_combined_noZ_90_10k.vcf - VCF used for EEMS input, with all ingroup individuals, Z excluded, 90% completeness, and 10kb thinning.

make_eems_input.slurm - Slurm script for filtering main VCFs then making eems input.

make_chains.sh - Simple bash script for copying chain1's parameters to 19 other chains.

run_eems.slurm - Slurm script for running EEMS chains without and with only Z as a Slurm array job.

The next are a set of input files for EEMS, each one has a version of only the Z and everything but the Z

***greenbul49_noZ_90_10k.bed - BED file with genetic data.

***greenbul49_noZ_90_10k.bim - BIM file outlining variants

greenbul49_noZ_90_10k.coord - File of sample coordinates.

greenbul49_noZ_90_10k.count - List of allele counts.

***greenbul49_noZ_90_10k.diffs - Genetic distances for eems.

greenbul49_noZ_90_10k.fam - FAM metadata file.

greenbul49_noZ_90_10k.order - Sample name orders.

greenbul49_noZ_90_10k.outer - EEMS outer bounds.

params_chain1 - Parameter file that is then cloned per chain.

plot_eems.R - R script for plotting eems output

### 10_finescale_popstruct

central22.txt / east22.txt / west5.txt - Text files of each genetic cluster.

make_pca.slurm - Slurm script for making subset VCFs per cluster.

***\[cluster]noZ_90_10k.recode.vcf - VCFs for respective clusters.

\*pops.csv - CSVs for population maps.

pop_coords.csv - CSV for coordinates for map (mostly eastern plus one central pop).

finescale_PCA.R - R script for plotting PCAs and map of elevation/sampling points.

### 11_isolation_tests

This section by Javier Colmenares.

### 12_abba_baba

This section by Ari Rice.

### 13_treemix

***greenbul51_noZ_100_mac5_10k.recode.treemix.frq.gz - Input file for treemix.

make_treemix_input.slurm - Slurm script for making treemix input.

***output_files.zip - Output files from running TreeMix. I lost the actual script in a scratch space purge (oops), but run it like this (where X is 0, 1, or 2 migration edges): 
	treemix -i INPUT -root virens -o OUTPUT -m X -se

treemix_plot.R - R script for plotting TreeMix, relies on TreeMix's default plotting functions


